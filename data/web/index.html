<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
    <style>p{white-space:pre;word-wrap:break-word;font-family:monospace;}</style>
    <title>Neato Console</title>
    <script language='javascript' type='text/javascript'>
      var b='ws://'+location.hostname+':81/',c,d,e;

      function g(){
        d=new WebSocket(b);
        d.onopen=function(){
          h('[connected]')
        };
        d.onclose=function(){
          h('[disconnected]')
        };
        d.onmessage=function(a){
          h('<span style=\"color: blue;\">[response] '+a.data+'</span>')
        };
        d.onerror=function(a){
          h('<span style=\"color: red;\">[error] </span> '+a.data)
        }
      }
      function k(a){
        if(13==a.keyCode){
          a=e.value;
          if('/disconnect'==a)
            d.close();
          else if('/clear'==a)
            for(;c.firstChild;)
              c.removeChild(c.firstChild);
          else
            '' != a && (h('[sent] '+a), d.send(a));
          e.value='';
          e.focus()
        }
      }
      function h(a){
        var f=document.createElement('p');
        f.innerHTML=a;
        c.appendChild(f);
        window.scrollTo(0,document.body.scrollHeight)
      }
      window.addEventListener('load', function(){
        c=document.getElementById('c');
        e=document.getElementById('i');
        g();
        document.getElementById('i').addEventListener('keyup', k, !1);
        e.focus()
      }, !1);
    </script>
  </head>
  <body>
    <h2>Neato Console</h2>
    <div id='c'></div>
    <input type='text' id='i' style=\"width:100%;font-family:monospace;\">
  </body>
</html>
